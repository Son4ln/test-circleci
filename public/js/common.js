$(function(){$(document).on('click','a.post-link',function(e){e.preventDefault();if($(this).attr('data-confirm')&&!confirm($(this).attr('data-confirm'))){return}
var token=$('meta[name="csrf-token"]').attr('content');var $form=$('<form/>').attr('action',$(this).attr('href')).attr('method','POST').append($('<input type="hidden" name="_token"/>').val(token)).append($('<input type="hidden" name="_method" value="DELETE"/>'));$form.appendTo($('body'));$form.submit()});$('a[data-toggle=popover]').popover();$.crluo.messageLoad($('#chatPopover, #infoPopover'));$('.ui-modal').click(function(){name=$(this).attr('data-procname');$('.modal-title','#modalWindow').html($(this).html());$('div.modal-body','#modalWindow').load('/'+name)});$('#modalWindow').on('hidden.bs.modal',function(e){$('div.modal-body','#modalWindow').html('')});$('span.ui-modal-message').click(function(){$('.modal-title','#modalWindow').html($(this).attr('data-title'));$('div.modal-body','#modalWindow').load($(this).attr('data-procname'))});$('[data-toggle="check-all"]').click(function(){var self=$(this)
$('input[type="checkbox"]',self.data('target')).prop('checked',self.prop('checked'))});$("[data-cbase]").click(function(){var self=$(this);var $id=$(this).data('cbase');var $label=$(this).hasClass('status-danger')?0:1;$('.loader').show();if(self.hasClass('status-success')){self.removeClass('status-success').addClass('status-danger')}else{self.removeClass('status-danger').addClass('status-success')}
$.ajax({url:'/creative-rooms/update-label',type:'post',data:{_token:$('meta[name="csrf-token"]').val(),id:$id,label:$label},success:function(data){},error:function(xhr,status){alert('Error Occur!');if(self.hasClass('status-success')){self.removeClass('status-success').addClass('status-danger')}else{self.removeClass('status-danger').addClass('status-success')}},complete:function(){$('.loader').fadeOut()}})});$("[data-loadcog]").click(function(e){e.preventDefault();var $id=$(this).data('loadcog');$('#modal .modal-body').text('Loading...');$.get('/creative-rooms/'+$id+'/member',function(response){$('#modal .modal-body').html(response)});$('#modal').modal('show')});$("[data-editroom]").click(function(e){e.preventDefault();var $id=$(this).data('editroom');$('#modal .modal-body').text('Loading...');$.get('/creative-rooms/'+$id+'/edit',function(response){$('#modal .modal-body').html(response)});$('#modal').modal('show')});$("[data-deleteroom]").click(function(e){e.preventDefault();var $form=$('#delete_room');if(confirm('このC-Baseプロジェクトを削除します。よろしいですか？')){$form.attr('action','/creative-rooms/delete/'+$(this).data('deleteroom'));$form.submit()}});$('#finish').submit(function(e){e.preventDefault();var $self=$(this);$('.preloader').show();$.ajax({url:$self.attr('action'),method:'POST',data:$self.serialize(),success:function(){$self.remove()},complete:function(){$('.preloader').fadeOut()}})});$('#c_base_create').click(function(){$.get('/creative-rooms/create',function(response){$('#project .modal-body').text('Loading...');$('#project .modal-body').html(response)})});$(document).on('change','#image',function(e){if(this.files&&this.files[0]){$('#file_name').text(this.files[0].name);$('#file_name + img').remove()}else{$('#file_name').text('')}});$(document).on('click','#refresh_link',function(){var $id=$(this).data('id');$.ajax({url:'/creative-rooms/token',type:'POST',data:{_token:$('meta[name="csrf-token"]').attr('content'),id:$id},success:function(response){$('#invitation_link').val(response)}})});$(document).on('click','#delete_user',function(e){e.preventDefault();var $this=$(this);if(!confirm('よろしいですか?'))
return;$.ajax({url:$this.prop('href'),type:'POST',dataType:'json',data:{_token:$('meta[name="csrf-token"]').attr('content'),id:$this.data('id'),_method:'DELETE'},success:function(response){$('#room_users_count').text(response.count);$this.parent().parent().remove()}})});$('.click-zone').click(function(e){$(this).find('.dropdown').toggleClass('open')});$(document).on("click",function(event){var $trigger=$(".dropdown");if($trigger!==event.target&&!$trigger.has(event.target).length){$(".dropdown-menu").removeClass('open')}});$(document).on('click','.accept_user',function(){var $this=$(this);if(!confirm('よろしいですか?'))
return;$.ajax({url:'/creative-rooms/accept',type:'POST',data:{_token:$('meta[name="csrf-token"]').attr('content'),id:$this.data('id'),},success:function(response){$('#room_users_count').text(response.count);$this.parent().text('参加中')},error:function(xhr){if(xhr.status==403){$('#message_limit').text(messages.member_limit);$('#message_limit').fadeIn()}}})})})