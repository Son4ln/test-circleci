!function(e){var t={};function a(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}({0:function(e,t,a){e.exports=a("bvSO")},bvSO:function(e,t){$(document).on("click",".ui-preview-movie",function(){$(this).addClass("bounce animated").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass("bounce animated")})}),$(document).on("mouseover",".ui-preview-movie",function(){$(this).find("div.video-menu").removeClass("hide")}),$(document).on("mouseout",".ui-preview-movie",function(){$(this).find("div.video-menu").addClass("hide")}),$("#compare").on("click",function(){$("#video-1").attr("src",$("#movie-1").data("src")),$("#video-2").attr("src",$("#movie-2").data("src"));var e=$("div[data-procname|='"+$("#movie-1").data("src")+"']").data("original-title"),t=$("div[data-procname|='"+$("#movie-2").data("src")+"']").data("original-title");$(".l-video-name-1").text(e),$(".l-video-name-2").text(t),void 0!=$("#movie-1").data("src")&&void 0!=$("#movie-2").data("src")?$("#compare-modal").modal("show"):alert(messages.not_enough)}),$("#compare-modal").on("hidden.bs.modal",function(){$("#video-1").attr("src",""),$("#video-2").attr("src","")}),$(window).on("load",function(){var e=[],t="";$(window).on("resize",function(){$("#pv-draw").height($("#pv-video").height()),$("#pv-caption").width($("#pv-video").width()),$("#pv-draw").width($("#pv-video").width()),$("#pv-caption").css("left",$("#pv-video").position().left),$("#pv-draw").css("left",$("#pv-video").position().left)}),$("span.ui-del-message").click(function(){ret=$.crluo.ajax_sync("/ajax/work/message",{del_id:$(this).attr("data-id"),creativeroom_id:$("#creativeroom_id").val()}),$(".ui-project-message").html(ret.data)}),$("span.ui-del-info").click(function(){ret=$.crluo.ajax_sync("/ajax/work/info",{del_id:$(this).attr("data-id"),creativeroom_id:$("#creativeroom_id").val()}),$(".ui-project-info").html(ret.data)}),$("#droppable").crluoFileDrop({url:"/files/upload/file",creativeroom_id:$("#creativeroom_id").val(),dest:".ui-project-file",progress:".ui-loader-progress"}),$(".ui-preview-list[data-remote]").crluoVideoList({creativeroom_id:$("#creativeroom_id").val(),progress:".ui-loader-progress"}),$('[data-toggle="tooltip"]',".ui-project-preview").tooltip(),$("#modalUrlWindow").on("hidden.bs.modal",function(e){$("#modalUrlText").html("")}),$(document).on("click","a.ui-share-movie",function(e){e.preventDefault(),id=$(this).attr("data-id"),data={id:id,creativeroom_id:$("#creativeroom_id").val()},$.ajax({url:"/guest/url/"+id,data:data,type:"post",dataType:"html",success:function(e){$("#modalUrlText","#modalUrlWindow").text(e)},error:function(e,t){$("#modalUrlText").text(e.responseText)}})});var a=[];$(document).on("click","div.ui-preview-movie",function(){$("#pv-video").remove();var e=document.createElement("video");e.id="pv-video",e.src=$(this).attr("data-procname"),e.controls=!1,e.autoplay=!0,e.loop=!1,e.muted=!1,e.setAttribute("data-fileid",$(this).attr("data-fileid")),$(e).insertBefore("#pv-caption");var i,o,r=$(this).attr("data-original-title")?$(this).attr("data-original-title"):$(this).attr("title");$(".ui-prev-title").text(r),n=$(this).attr("data-fileid"),c(),l(),l(),$("#pv-draw").children().remove(),$("input","#pv-text").val(""),$("#pv-text").hide(),$("#pv-video").on("loadedmetadata",function(){(t=new Date).setHours(0,0,$("#pv-video")[0].duration,0),i=t.toLocaleTimeString().replace(/ JST/,"")}),$("#pv-video").on("play",function(){$(".ui-player-play").children().addClass("glyphicon-pause").removeClass("glyphicon-play"),$(".ui-player-play").removeClass("ui-unselected").addClass("ui-selected")}),$("#pv-video").on("pause",function(){$(".ui-player-play").children().addClass("glyphicon-play").removeClass("glyphicon-pause")}),$("#pv-video").on("timeupdate",function(e){$("#pv-caption").height($("#pv-video").height()),$("#pv-draw").height($("#pv-video").height()),$("#pv-caption").width($("#pv-video").width()),$("#pv-draw").width($("#pv-video").width()),$("#pv-caption").css("left",$("#pv-video").position().left),$("#pv-draw").css("left",$("#pv-video").position().left);var t=$(this)[0].currentTime;$.each($("#progress").children("span"),function(e,a){t>a.getAttribute("data-begin")&&t<a.getAttribute("data-end")&&$(a).find("div").addClass("active"),(t>a.getAttribute("data-end")||t<a.getAttribute("data-begin"))&&$(a).find("div").removeClass("active")}),$.each($("#pv-draw").children(),function(e,a){t>a.getAttribute("data-begin")&&t<a.getAttribute("data-end")&&(a.style.display="block"),(t>a.getAttribute("data-end")||t<a.getAttribute("data-begin"))&&(a.style.display="none")}),$('[data-end="'+Math.round(t)+'"]').removeClass("active");var a=new Date;a.setHours(0,0,t,0),$(".ui-prev-time").text(a.toLocaleTimeString().replace(/ JST/,"")+" / "+i),$("#pv-pgss").css({width:t/$(this)[0].duration*100+"%"}),$("#pv-video").height()}),(o=document.getElementById("pv-video")).addEventListener("timeupdate",function(){var e=parseInt(o.currentTime),t=jQuery.inArray(e,a);if(-1!==t){var i=".h-"+e;$(".tasks").find("div:not("+i+")").removeClass("l-highlight"),setTimeout(function(){$(".h-"+e).hasClass("l-highlight")||$(".h-"+e).addClass("l-highlight")},100)}}),o.addEventListener("playing",function(){var e=parseInt(o.currentTime);-1!==jQuery.inArray(e,a)&&setTimeout(function(){$(".h-"+e).addClass("l-highlight")},100)}),o.addEventListener("seeked",function(){$(".task-element").removeClass("l-highlight")})}),$(document).on("click","a.ui-delete-movie",function(e){e.preventDefault();var t=$(".preloader").fadeIn();id=$(this).attr("data-id"),$data={del_id:id,creativeroom_id:$("#creativeroom_id").val()},$.ajax({url:"/ajax/work/preview",data:$data,type:"post",dataType:"html",success:function(e){$(".ui-project-preview").html(e),t.fadeOut()},error:function(e,t){$(".preloader").html(e.responseText)}})});var o,r,n,d=[],s="http://www.w3.org/2000/svg";function c(){var t=$("#pv-draw").width(),i=$("#pv-draw").height();$(window).width()<1400&&(t=900,i=480),d=[],$("#pv-list").empty(),$("#progress span").remove(),$.getJSON("/files/captions",{file_id:n},function(o){$("#progress").width();e=[],$.each(o,function(o,r){var n=parseInt(r.start);if(-1==jQuery.inArray(parseInt(r.start),a)&&a.push(n),d.push(r),e.push(Math.round(r.start)),$("#pv-list").append(function(e){console.log(e);var t="h-"+parseInt(e.start),a=$("<div></div>",{class:"task-element "+t+" le-"+$(".ui-preview-movie.active").attr("data-fileid"),"data-start":e.start}),i=$("<div></div>",{class:"status-bar "+(d=e.status,1==d?"bar-success":"bar-danger"),"data-id":e.id}),o=$("<div></div>",{class:"caption-image"}).append($("<img>",{src:e.photo,class:"img-circle",width:40})),r=$("<div></div>",{class:"caption-content"}).append($("<h5></h5>").text(e.name).append('<span class="l-s-time">'+e.start_format+"</span>")),n=e.title.text;var d;n=n.length>50?n.substr(0,49)+'<a data-full-text="'+e.title.text+'" href="javascript:;" class="l-see-all" > >> </a>':e.text;return n="<p>"+n+"</p>",r.append(n),a.append(i),a.append(o),a.append(r),a}(r)),2==r.kind){var c=document.createElementNS(s,"rect");$.each(r.title,function(e,a){"x"!=e&&"width"!=e||-1!=a.indexOf("%")?"y"!=e&&"height"!=e||-1!=a.indexOf("%")?c.setAttribute(e,a):c.setAttribute(e,a/i*100+"%"):c.setAttribute(e,a/t*100+"%")}),c.style.display="none",$("#pv-draw").append(c)}var l=setInterval(function(){if($("#pv-video")[0].readyState>0){var e="";r.text.length>60?(r.text=r.text.substr(0,60)+"...",e="l-width-350"):r.text.length>20&&(e="l-width-350");var t=r.start/$("#pv-video")[0].duration*100,a=document.createElement("span");a.setAttribute("class","marker"),a.setAttribute("data-high-light",n),a.style.left=Math.round(t)+"%",a.setAttribute("data-begin",r.title["data-begin"]),a.setAttribute("data-end",r.title["data-end"]);var i=document.createElement("div");i.setAttribute("class","bubble "+e),i.innerText=r.text,a.append(i),$("#progress").append(a),clearInterval(l)}},500)})})}function l(){dragging=!1,$("#pv-draw").css("cursor","auto"),$("#pv-draw").unbind("mousemove"),$("button","#pv-controller-controll").removeClass("ui-selected").addClass("ui-unselected")}$(document).on("click",".delete-preview",function(){var e=this,t=$(this).attr("data-id");$.ajax({method:"DELETE",url:"/previews/"+t,success:function(){c(),e.parent().parent().remove()},error:function(){console.log("error")}})}),$("#pv-pgss").parent().click(function(e){var t=$(e.target).parent().attr("data-high-light");$(".task-element").removeClass("l-highlight"),setTimeout(function(){$(".h-"+t).addClass("l-highlight")},100),$("#pv-video")[0].currentTime=e.offsetX/$(this).width()*$("#pv-video")[0].duration}),$(".ui-player-rect").click(function(){var e,t=!1;$("#pv-draw").height($("#pv-video").height()),l(),$(".ui-player-rect").removeClass("ui-unselected").addClass("ui-selected"),$("#pv-video").each(function(){$(this)[0].pause()}),$("#pv-draw").css("cursor","crosshair"),$("#pv-draw").one("mousedown",function(a){var i,o,r=$("#pv-draw").width(),n=$("#pv-draw").height(),d=0,c=0;$("#pv-draw").bind("mousemove",function(a){if(t){var s=a.offsetX,l=a.offsetY;s-i<0?(e.setAttribute("x",s),d=(i-s)/r*100,e.setAttribute("width",d+"%")):(d=(s-i)/r*100,e.setAttribute("width",d+"%")),l-o<0?(e.setAttribute("y",l),c=(o-l)/n*100,e.setAttribute("height",c+"%")):(c=(l-o)/n*100,e.setAttribute("height",c+"%"))}}),t=!0,i=a.offsetX,o=a.offsetY,(e=document.createElementNS(s,"rect")).setAttribute("x",i/r*100+"%"),e.setAttribute("y",o/n*100+"%"),$("#pv-draw").append(e)}),$("#pv-draw").one("mouseup",function(e){l(),o=e.offsetX,r=e.offsetY,$(".ui-player-text").click(),$("#captionType").val("rect")})}),$(".ui-player-text").click(function(e){$("#captionType").val("text"),$("#pv-video").each(function(){$(this)[0].pause()}),l(),$(".ui-player-text").removeClass("ui-unselected").addClass("ui-selected"),e.offsetX>0&&(o=e.offsetX,r=$("#pv-draw").height()-200),$("#pv-text").css({left:o+50,top:r}),$("#pv-text").show(),$(".ui-prev-input").width()+o+50>$("#pv-text").width()&&$("#pv-text").css("left",o-$(".ui-prev-input").width()-50)}),$(".ui-player-play").click(function(){l(),$("#pv-video")[0].paused?$("#pv-video")[0].play():$("#pv-video")[0].pause()}),$(".ui-player-mute").click(function(){l(),$("#pv-video")[0].muted=!$("#pv-video")[0].muted,$("span",".ui-player-mute").toggleClass("glyphicon-volume-off").toggleClass("glyphicon-volume-up")}),$("button","#pv-text").click(function(){if("cancel"==$(this).attr("data-kind")||""==$("input","#pv-text").val()&&0==$("#pv-draw").children().length)$("#pv-draw").children().remove();else{var e=$("#pv-video")[0].currentTime,t=e+parseFloat($("select","#pv-text").val()),a={};if(a.attr={},"rect"==$("#captionType").val()){var i=$("#pv-draw").children(),o=i[i.length-1];$.each($(o)[0].attributes,function(e,t){a.attr[t.name]=t.value}),a.kind=2}a.attr["data-begin"]=e,a.attr["data-end"]=t,a.attr.text=$("input","#pv-text").val(),a.file_id=$("#pv-video").attr("data-fileid"),a.creativeroom_id=$("#creativeroom_id").val(),a._token=$('meta[name="csrf-token"]').attr("content"),$(".preloader").show(),$.ajax({url:"/previews",data:a,type:"post",dataType:"html",success:function(e){c(),$("#messages").append(e)},error:function(e,t){},complete:function(e,t){$(".preloader").fadeOut()}})}$("#pv-text").hide(),$("input","#pv-text").val(""),l()}),l(),$("button.ui-accept-checked").click(function(){var e=$(".preloader").fadeIn();id=$(this).attr("data-id"),data={creativeroom_id:$("#creativeroom_id").val()},$.ajax({url:"/ajax/work/checked",data:data,type:"post",dataType:"html",success:function(t){$(".ui-project-deliver").html(t),e.fadeOut()},error:function(e,t){$(".preloader").html(e.responseText)}})}),$("button.ui-accept-deliver").click(function(){var e=$(".preloader").fadeIn();id=$(this).attr("data-id"),$data={creativeroom_id:$("#creativeroom_id").val()},$.ajax({url:"/ajax/work/accept",data:$data,type:"post",dataType:"html",success:function(t){$(".ui-project-deliver").html(t),e.fadeOut()},error:function(e,t){$(".preloader").html(e.responseText)}})}),$("#restart").on("click",function(){$("#pv-video")[0].currentTime=0}),$("#prev").on("click",function(){$("#pv-video")[0].currentTime-=5}),$("#next").on("click",function(){$("#pv-video")[0].currentTime+=5}),$(document).on("click",".task-element:not(.l-see-all)",function(e){"A"!=$(e.target).context.nodeName&&($("#pv-video")[0].currentTime=$(this).data("start"))}),$(".preview-control").click(function(){$(".preview-control").removeClass("btn-warning").addClass("btn-default"),$(this).addClass("btn-warning").removeClass("btn-default"),$(".pane").addClass("hidden");var e=$(this).data("href");$(e).removeClass("hidden")}),$(".video-control.play").click(function(){4==$("#video-1")[0].readyState&&4==$("#video-2")[0].readyState&&($("#video-1")[0].paused?($("#video-1")[0].play(),$("#video-2")[0].play(),$("#video-2")[0].currentTime=$("#video-1")[0].currentTime):($("#video-1")[0].pause(),$("#video-2")[0].pause()))}),$("#video-1").on("canplay",function(){1==$("#video-2")[0].readyState&&($("#video-1").get(0).play(),$("#video-2").get(0).play())}),$("#video-1").on("loadedmetadata",function(){var e=$(this).get(0).duration;$(".duration").text(i(e))}),$("#video-2").on("canplay",function(){1==$("#video-1")[0].readyState&&($("#video-1").get(0).play(),$("#video-2").get(0).play())}),$("#video-1").on("play",function(){$(".video-control.play").html('<i class="fa fa-pause"></i>')}),$("#video-1").on("pause",function(){$(".video-control.play").html('<i class="fa fa-play"></i>')}),$(".video-control.restart").click(function(){4==$("#video-1")[0].readyState&&4==$("#video-2")[0].readyState&&($("#video-1")[0].currentTime=0,$("#video-2")[0].currentTime=0,$("#video-1")[0].play(),$("#video-2")[0].play())}),$(".video-control.forward").click(function(){4==$("#video-1")[0].readyState&&4==$("#video-2")[0].readyState&&($("#video-1")[0].currentTime+=5,$("#video-2")[0].currentTime+=5)}),$(".video-control.backward").click(function(){4==$("#video-1")[0].readyState&&4==$("#video-2")[0].readyState&&($("#video-1")[0].currentTime-=5,$("#video-2")[0].currentTime-=5)}),$(".video-control.backward").click(function(){4==$("#video-1")[0].readyState&&4==$("#video-2")[0].readyState&&($("#video-1")[0].currentTime-=5,$("#video-2")[0].currentTime-=5)}),$(".video-control.volume").click(function(){4==$("#video-1")[0].readyState&&4==$("#video-2")[0].readyState&&($("#video-1").prop("muted",!$("#video-1")[0].muted),$("#video-2").prop("muted",!0))}),$("#video-1").on("volumechange",function(){1==$("#video-1")[0].muted?$(".video-control.volume").html('<i class="fa fa-volume-off"></i>'):$(".video-control.volume").html('<i class="fa fa-volume-up"></i>')}),$("#video-1").on("timeupdate",function(){var e=$("#video-1")[0].currentTime;$(".compare-progress-bar").css({width:e/$(this)[0].duration*100+"%"}),$(".current-time").text(i(e))}),$(".compare-progress").click(function(e){$("#video-1")[0].currentTime=e.offsetX/$(this).width()*$("#video-1")[0].duration,$("#video-2")[0].currentTime=e.offsetX/$(this).width()*$("#video-1")[0].duration});var u="";$(document).on("dragstart",".movie-drag",function(){u=$(this).data("procname")}),$(document).on("dragend",".movie-drag",function(){u=""}),$(".compare .storage").on("dragover",function(e){e.preventDefault(),e.stopPropagation(),""!=u&&$(this).addClass("btn-warning").removeClass("btn-default")}),$(".compare .storage").on("dragleave",function(e){e.preventDefault(),e.stopPropagation(),$(this).removeClass("btn-warning").addClass("btn-default")}),$(".compare .storage").on("drop",function(e){e.preventDefault(),e.stopPropagation(),""!=u&&($(this).addClass("btn-success").removeClass("btn-default btn-warning"),$(this).data("src",u)),u=""}),$(document).on("click",".ui-del-file, .ui-del-deliver",function(e){e.stopPropagation();var t=$(this);confirm(messages.confirm_delete)&&($(".preloader").fadeIn(),$.ajax({url:"/files/"+t.data("id"),type:"POST",data:{_token:$('meta[name="csrf-token"]').attr("content"),_method:"DELETE"},success:function(){t.parents(".delivery").remove(),$(".delivery").length>0?$(".download-all-file").removeClass("hide"):$(".download-all-file").addClass("hide")},complete:function(){$(".preloader").fadeOut()}}))}),$("div.ui-preview-movie").click(function(){$("div.ui-preview-movie").removeClass("active"),$(this).addClass("active")}),$(document).on("click",".ui-del-preview",function(e){e.stopPropagation();var t=$(this);confirm(messages.confirm_delete)&&($(".tooltip").hide(),$(".preloader").fadeIn(),$.ajax({url:"/files/"+t.data("id"),type:"POST",data:{_method:"DELETE",_token:$('meta[name="csrf-token"]').attr("content")},success:function(){t.parents(".ui-preview-movie").remove();var e="/files/preview/"+$("#creativeroom_id").val();$.get(e,function(e){$(".compare-list").html(e)})},complete:function(){$(".preloader").fadeOut()}}))}),$(document).on("submit","#room-config",function(e){e.preventDefault();var t=$(this),a=$.crluo.ajax_sync(t.prop("action"),t.serialize());$("#config").html(a.data)}),$(document).on("click",".status-bar",function(){var e=$(this),t=$(this).data("id"),a=$(this).hasClass("bar-success")?0:1;$(".preloader").show(),$.ajax({url:"/tasks/update",data:{_token:$('meta[name="csrf-token"]').val(),id:t,state:a},type:"post",dataType:"html",success:function(t){e.hasClass("bar-success")?e.removeClass("bar-success").addClass("bar-danger"):e.removeClass("bar-danger").addClass("bar-success")},error:function(e,t){alert("Error Occur!")},complete:function(){$(".preloader").fadeOut()}})}),$(document).on("click","a.l-see-all",function(){var e=$(this).attr("data-full-text"),t=$(this).parent();t.empty(),t.text(e),$(this).remove()})}),$('[data-filter="hankaku"]').keydown(function(e){[8,46,37,39,35,36,229,13,9].indexOf(e.keyCode)>-1||(e.keyCode<48||e.keyCode>57)&&e.preventDefault()}),$('[data-filter="hankaku"]').focusout(function(){$(this).val(a($(this).val()))});var a=function(e,t){function a(e){return t(e.charCodeAt(0)-65248)}return function(t){return e(t).replace(/\u2019/g,"'").replace(/\u201D/g,'"').replace(/\u3000/g," ").replace(/\uFFE5/g,"¥").replace(/[\uFF01\uFF03-\uFF06\uFF08\uFF09\uFF0C-\uFF19\uFF1C-\uFF1F\uFF21-\uFF3B\uFF3D\uFF3F\uFF41-\uFF5B\uFF5D\uFF5E]/g,a)}}(String,String.fromCharCode);function i(e){e=Math.round(e);var t=Math.floor(e/3600),a=e%3600,i=Math.floor(a/60),r=a%60,n=Math.ceil(r);return o(t)+":"+o(i)+":"+o(n)}function o(e){return e<10?"0"+e:e}}});
