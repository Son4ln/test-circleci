function clickOnNextArrow(){$('a[href^="#"].scrollarrow-blue50, a[href^="#"].scrollarrow-blue80').click(function(){var speed=700;var href=$(this).attr("href");var target=$(href=="#"||href==""?'html':href);var position=target.offset().top-60;$('body,html').animate({scrollTop:position},speed,'swing');return!1})}
function setOnChangeForCheckbox(bindClassName,styleOfCheckedOn){$(".bind_"+bindClassName+" input[type='checkbox']").change(function(e){setBackgroundAndSendContentsToPreviewPartWithCommaDelimited(bindClassName,styleOfCheckedOn);validate();if($(this).prop('checked')==!0){$(this).parent().addClass(styleOfCheckedOn);if(bindClassName==deliveryDate){$("#delivery_date").prop("disabled",!0)}
if(bindClassName==expirationDate){$("#expiration_date").prop("disabled",!0)}}else{$(this).parent().removeClass(styleOfCheckedOn);if(bindClassName==deliveryDate){$("#delivery_date").prop("disabled",!1);$("#"+bindClassName).trigger('change')}
if(bindClassName==expirationDate){$("#expiration_date").prop("disabled",!1);$("#expiration_date").trigger('change')}}})}
function setOnChangeForRadioButton(bindClassName,styleOfCheckedOn){$(".bind_"+bindClassName+" input[type='radio']").change(function(e){setBackgroundAndSendContentsToPreviewPartWithCommaDelimited(bindClassName,styleOfCheckedOn);if($(this).is(":checked")){$(".bind_"+bindClassName+" input[type='radio']").parent().removeClass(styleOfCheckedOn);$(this).parent().addClass(styleOfCheckedOn);if(bindClassName=="close_to_image"){$(".bind_"+bindClassName+" input[type='radio']").parent().parent().removeClass(styleOfCheckedOn);$(this).parent().parent().addClass(styleOfCheckedOn)}
if(bindClassName=="purpose"){var purposetext=$(this).parent().text()+"を獲得するのは何ですか？";$(".purposetext").text(purposetext)}}})}
function setOnChangeForInputText(bindId,defaultValue){$("#"+bindId).change(function(e){var textValue=defaultValue;if($(this).val()!=""){textValue=$(this).val()}
$(".preview_"+bindId+" span:first").text(escapeHtml(textValue));if(bindId==expirationDate){if(isValidExpirationDate($('#'+bindId).val())){$('#expired_at_error').text('')}else{$('#expired_at_error').text($('#expired_at_error').data('message'))}}
validate()})}
function addDays(theDate,days){return new Date(theDate.getTime()+days*24*60*60*1000)}
function isValidExpirationDate(date)
{var now=new Date();var jst=540+now.getTimezoneOffset();var today=new Date(now.valueOf()+jst*60000);today=addDays(today,30);var compareDate=new Date(date);return(compareDate>now)&&(compareDate<today)}
function escapeHtml(string){if(typeof string!=='string'){return string}
return string.replace(/[&'`"<>]/g,function(match){return{'&':'&amp;',"'":'&#x27;','`':'&#x60;','"':'&quot;','<':'&lt;','>':'&gt;',}[match]})}
function setPreviewText($element,$wrapper)
{var preview='';$($element).on('change',function(){$(".bind_"+$wrapper+" input[type='checkbox']:checked").each(function(){$(this).parent().addClass(labelBackOn);txt=$(this).next().text();if(txt!=""){delimiter=(preview=="")?"":",";preview+=delimiter+txt}});if($($element).val()){if(preview.trim()!=''){preview+=', '+$($element).val()}else{preview=$($element).val()}}
$(".preview_"+$wrapper+" span:first").text(escapeHtml(preview));validate()})}
var usuallyCreator={min:5,max:500,defaultLowerLimit:20,defaultUpperLimit:30,maxRangeWidth:100};var certifiedCreator={min:10,max:500,defaultLowerLimit:50,defaultUpperLimit:100,maxRangeWidth:100};var creator=usuallyCreator;$("#request_form_table th, #request_form_table td").click(function(event){var targetIndex=$(event.currentTarget).index();var counter=0;$("#request_form a").each(function(){counter++;if(targetIndex==counter){$(this).trigger('click')}})});$("#request_form a").click(function(){$(".preview_request_form span:first").text($(this).children().text());validate();$(".selected_message").css("visibility","hidden");var id=$(this).prev().prop("id");if(id=="certified_creator"){$(this).prev().css("visibility","visible");creator=certifiedCreator;$('input[name="is_certcreator"]').val(1)}else if(id=="self_competition"){$(this).prev().css("visibility","visible");$('input[name="is_certcreator"]').val(0);creator=usuallyCreator}else{creator=usuallyCreator;$('input[name="is_certcreator"]').val(0)}
initializeSlider()});function changeLinkStyle(lower,upper){}
function sendBudgetToPreviewPart(lowerLimit,upperLimit){var budget="";if(lowerLimit!=""&&upperLimit!=""){budget=lowerLimit+"～"+upperLimit+"万円"}
$(".preview_budget span:first").text(escapeHtml(budget));validate()}
function slider(obj){if(obj){if(!$.isNumeric(obj.value)){obj.focus();sendBudgetToPreviewPart("","");return!1}
var intLowerLimit=parseInt($("#lower_limit").val());var intUpperLimit=parseInt($("#upper_limit").val());if((intLowerLimit<0)||(intUpperLimit<0)){obj.focus();sendBudgetToPreviewPart("","");return!1}
if((intLowerLimit<creator.min)||(creator.max<intUpperLimit)){obj.focus();sendBudgetToPreviewPart("","");return!1}
if(intUpperLimit<intLowerLimit){obj.focus();sendBudgetToPreviewPart("","");return!1}
if(creator.maxRangeWidth<(intUpperLimit-intLowerLimit)){if(obj.id=="lower_limit"){$("#upper_limit").val(creator.maxRangeWidth-intLowerLimit)}
else if(obj.id=="upper_limit"){$("#lower_limit").val(intUpperLimit-creator.maxRangeWidth)}}}
$(function(){$("#slider-range").slider({orientation:'vertical',range:!0,min:creator.min,max:creator.max,values:[$("#lower_limit").val(),$("#upper_limit").val()],slide:function(event,ui){var lowerLimitBeforeMovement=$("#lower_limit").val();var upperLimitBeforeMovement=$("#upper_limit").val();var lowerLimitAfterMovement=ui.values[0];var upperLimitAfterMovement=ui.values[1];if(lowerLimitAfterMovement!=lowerLimitBeforeMovement){if((upperLimitAfterMovement-lowerLimitAfterMovement)>creator.maxRangeWidth){upperLimitAfterMovement=lowerLimitAfterMovement+creator.maxRangeWidth}}
else if(upperLimitAfterMovement!=upperLimitBeforeMovement){if((upperLimitAfterMovement-lowerLimitAfterMovement)>creator.maxRangeWidth){lowerLimitAfterMovement=upperLimitAfterMovement-creator.maxRangeWidth}}
$("#lower_limit").val(lowerLimitAfterMovement);$("#upper_limit").val(upperLimitAfterMovement);slider()}});$('#upper_limit').keyup(function(e){var allowKeys=[8,46,37,39,35,36,229,13,9,91];if(allowKeys.indexOf(e.keyCode)>-1){return!1}
var upperValue=parseInt($('#upper_limit').val());var lowerValue=parseInt($('#lower_limit').val());if(upperValue<lowerValue){return!1}
$(this).change();return!1
console.log(e.keyCode)});$('#lower_limit').keyup(function(e){var allowKeys=[8,46,37,39,35,36,229,13,9,91];if(allowKeys.indexOf(e.keyCode)>-1){return!1}
var upperValue=parseInt($('#upper_limit').val());var lowerValue=parseInt($('#lower_limit').val());var setUpperValue=lowerValue+creator.maxRangeWidth;if(setUpperValue>creator.max){setUpperValue=creator.max}
console.log(lowerValue+creator.maxRangeWidth);$('#upper_limit').val(setUpperValue);upperValue=parseInt($('#upper_limit').val());lowerValue=parseInt($('#lower_limit').val());if(lowerValue>=creator.max){$('#lower_limit').val(creator.max)}
var val=upperValue<lowerValue?lowerValue:upperValue;$('#slider-range').slider('values',1,val);l_price_filter()});$('#lower_limit').change(function(){var lowerValue=parseInt($(this).val());var upperValue=parseInt($('#upper_limit').val());if(lowerValue<creator.min){lowerValue=creator.min;$(this).val(lowerValue)}
var val=lowerValue>upperValue?upperValue:lowerValue;$('#slider-range').slider('values',0,val);$(this).val(val);if(upperValue-lowerValue>creator.maxRangeWidth){$('#upper_limit').val(lowerValue+creator.maxRangeWidth);$('#upper_limit').change()}});$('#upper_limit').change(function(){var upperValue=parseInt($(this).val());var lowerValue=parseInt($('#lower_limit').val());if(upperValue>creator.max){upperValue=creator.max;$(this).val(upperValue)}
var val=upperValue<lowerValue?lowerValue:upperValue;$(this).val(val);$('#slider-range').slider('values',1,val);if(upperValue-lowerValue>creator.maxRangeWidth){$('#lower_limit').val(upperValue-creator.maxRangeWidth);$('#lower_limit').change()}})});changeLinkStyle($("#lower_limit").val(),$("#upper_limit").val());sendBudgetToPreviewPart($("#lower_limit").val(),$("#upper_limit").val())}
$("#budget_undecided").change(function(){if($(this).prop('checked')==!0){$("#lower_limit").prop("disabled",!0);$("#upper_limit").prop("disabled",!0);$(".preview_budget span:first").text($(this).val());$("#slider-range").css("visibility","hidden")}else{$("#lower_limit").prop("disabled",!1);$("#upper_limit").prop("disabled",!1);sendBudgetToPreviewPart($("#lower_limit").val(),$("#upper_limit").val());$("#slider-range").css("visibility","visible")}});function initializeSlider(){$("#lower_limit").val(creator.defaultLowerLimit);$("#upper_limit").val(creator.defaultUpperLimit);$("#lower_limit_of_scale").text(creator.min+"万円");$("#upper_limit_of_scale").text(creator.max+"万円");slider()}
var movieStyle="movie_style";var movieType="movie_type";var requestWhat="request_what";var arrangeAnything="arrange_anything";var shootingLocation="shooting_location";var purpose="purpose";var purposeDetail="purpose_detail";var projectName="project_name";var deliveryDate="delivery_date";var expirationDate='expiration_date';var labelBackOn="label-back-on";var movieBackOn="movietype1-back-on";function setBackgroundAndSendContentsToPreviewPartWithCommaDelimited(bindClassName,styleOfCheckedOn){preview="";$(".bind_"+bindClassName+" input[type='checkbox']:checked").each(function(){$(this).parent().addClass(styleOfCheckedOn);txt=$(this).next().text();if(txt!=""){delimiter=(preview=="")?"":",";preview+=delimiter+txt}});if(bindClassName==arrangeAnything){if($("#client_arrange_text").val()){if(preview!=''){preview+=', '+$("#client_arrange_text").val()}else{preview=$("#client_arrange_text").val()}}}
if(bindClassName==requestWhat){if($("#request_other").val()){if(preview!=''){preview+=', '+$("#request_other").val()}else{preview=$("#request_other").val()}}}
$(".preview_"+bindClassName+" span:first").text(escapeHtml(preview));validate()}
$(document).ready(function(){var mode="create";if($("input[name='is_certcreator']").val()=="0"||$("input[name='is_certcreator']").val()=="1"){mode="edit"}
if(mode=="edit"){if($("input[name='is_certcreator']").val()==0){creator=usuallyCreator;$("#self_competition").css("visibility","visible");$(".preview_request_form span:first").text($("#self_competition").next().children().text())}else if($("input[name='is_certcreator']").val()==1){creator=certifiedCreator;$("#certified_creator").css("visibility","visible");$(".preview_request_form span:first").text($("#certified_creator").next().children().text())}
if($("#budget_undecided").prop("checked")==!0){initializeSlider();$("#budget_undecided").trigger("change")}else if($("#lower_limit").val()!=""){creator.defaultLowerLimit=$("#lower_limit").val();creator.defaultUpperLimit=$("#upper_limit").val();initializeSlider()}
setBackgroundAndSendContentsToPreviewPartWithCommaDelimited(movieStyle,labelBackOn);setBackgroundAndSendContentsToPreviewPartWithCommaDelimited(movieType,movieBackOn);setBackgroundAndSendContentsToPreviewPartWithCommaDelimited(requestWhat,labelBackOn);setBackgroundAndSendContentsToPreviewPartWithCommaDelimited(arrangeAnything,labelBackOn);$("#"+shootingLocation).trigger('change');$("#"+purpose).trigger('change');$("#"+projectName).trigger('change');if($("#"+deliveryDate).val()!=""){$("#"+deliveryDate).trigger("change")}else{$(".bind_"+deliveryDate+" input[type='checkbox']").trigger("change")}
if($('#expiration_date').val()!=""){$('#expiration_date').trigger("change")}else{$(".bind_"+expirationDate+" input[type='checkbox']").trigger("change")}}
$("#"+purposeDetail).trigger('change');validate();clickOnNextArrow();$('input[name="image"]').change(function(e){if(this.files&&this.files[0]){var reader=new FileReader();reader.onload=function(e){$('#project_image').attr('src',e.target.result)}
reader.readAsDataURL(this.files[0])}else{$('#project_image').attr('src','')}})});setOnChangeForCheckbox(movieStyle,labelBackOn);setOnChangeForCheckbox(movieType,movieBackOn);setOnChangeForCheckbox(requestWhat,labelBackOn);setOnChangeForCheckbox(arrangeAnything,labelBackOn);setOnChangeForCheckbox(deliveryDate,labelBackOn);setOnChangeForCheckbox(expirationDate,labelBackOn);setPreviewText('#request_other',requestWhat);setPreviewText('#client_arrange_text',arrangeAnything);$("#movie_type_another").click(function(){$(".bind_movie_type li").each(function(){$(this).css("display","list-item")});$(this).parent().css("display","none")});setOnChangeForInputText(shootingLocation,"特に指定なし または カメラマンに相談");setOnChangeForInputText(purpose,"");setOnChangeForInputText(purposeDetail,"");setOnChangeForInputText(projectName,"");$.datepicker.setDefaults($.datepicker.regional.ja);$("#"+deliveryDate).datepicker({dateFormat:'yy/mm/dd',minDate:'1'});$("#expiration_date").datepicker({dateFormat:'yy/mm/dd',minDate:'1'});setOnChangeForInputText(deliveryDate,"");setOnChangeForInputText(expirationDate,"");$("#arrange_anything_another").change(function(){$(".bind_arrange_anything input[type='checkbox']").trigger("change")});var fileUpload=!0;$('#exampleInputFile').on('change',function(){if(this.files.length>0){if(this.files[0].size&&this.files[0].size>parseInt(maximumKb)){$(this).parent().find('p').remove();$("#submit_btn").prop("disabled",!0);fileUpload=!1;alert(maximumMb+'B以下のファイルを選択してください');$(this).parent().append('<p style="color:red">'+maximumMb+'B以下のファイルを選択してください</p>')}else{$("#submit_btn").prop("disabled",!1);$(this).parent().find('p').remove();fileUpload=!0}}else{$(this).parent().find('p').remove()}});function validate(){var result=!0;$("#preview_table td").each(function(){if($(this).hasClass("preview_shooting_location")){return}
if($(this).hasClass('preview_delivery_date')){if($('input[name="is_duedate_undecided"]').prop('checked')){$(this).children("a").css("color","#333")
$(this).children('span:first').text('未定')
return}
$(this).children('span:first').text($('#delivery_date').val())}
if($(this).hasClass('preview_expiration_date')){if($('input[name="is_expiration_undecided"]').prop('checked')){$(this).children("a").css("color","#333")
$(this).children('span:first').text('未定')
return}
if(isValidExpirationDate($('#expiration_date').val())){$(this).children('span:first').text($('#expiration_date').val())}else{$(this).children('span:first').text('')}}
var content=$(this).children("span:first").text();if(content==""){$(this).children("a").css("color","red");result=!1}else{$(this).children("a").css("color","#333")}
if($(this).hasClass("preview_purpose")){if(200<$(this).children("span:first").text().length){$(this).children("a").css("color","#333");result=!1}}});if(3000<$(".preview_purpose_detail span:first").text().length||$(".preview_purpose_detail span:first").text().trim().length==0||$('#purpose').val().trim()==''){$("#preview_purpose_detail_pencil").css("color","red");result=!1}else{$("#preview_purpose_detail_pencil").css("color","#333")}
if(result&&fileUpload){$("#submit_btn").prop("disabled",!1)}}
$(document).on('mouseup','#slider-range',function(){$('#lower_limit').trigger('change')});$('#request_form_table').click(function(){$('#lower_limit').trigger('change')});$('.label-style').click(function(){$('#'+$(this).attr('for')).click()});$('#price input').change(function(){l_price_filter()});$("#request_form_table").hover(function(){$(this).css("cursor","pointer")},function(){$(this).css("cursor","default")});function l_price_filter(){$.ajax({url:'/portfolios/price-filter',type:'POST',dataType:'html',data:{lower:$('#lower_limit').val(),upper:$('#upper_limit').val(),_token:$('meta[name="csrf-token"]').attr('content')},success:function(response){$('#portfolio-list').html(response)},error:function(){$('#portfolio-list').text('')}})}
$('[data-filter="hankaku"]').keydown(function(e){var allowKeys=[8,46,37,39,35,36,229,13,9];if(allowKeys.indexOf(e.keyCode)>-1){return}
if(e.keyCode<48||e.keyCode>57){e.preventDefault()}});$('[data-filter="hankaku"]').focusout(function(){$(this).val(toHankaku($(this).val()))});var toHankaku=(function(String,fromCharCode){function toHankaku(string){return String(string).replace(/\u2019/g,'\u0027').replace(/\u201D/g,'\u0022').replace(/\u3000/g,'\u0020').replace(/\uFFE5/g,'\u00A5').replace(/[\uFF01\uFF03-\uFF06\uFF08\uFF09\uFF0C-\uFF19\uFF1C-\uFF1F\uFF21-\uFF3B\uFF3D\uFF3F\uFF41-\uFF5B\uFF5D\uFF5E]/g,alphaNum)}
function alphaNum(token){return fromCharCode(token.charCodeAt(0)-65248)}
return toHankaku})(String,String.fromCharCode);slider()